<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kato’s T-Gel Daily Tracker</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<style>
  :root{--bg:#0b0c10;--card:#15171c;--ink:#e9edf1;--muted:#9ba3ae;--accent:#6ee7ff;--accent2:#a78bfa}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,Segoe UI,Roboto;background:var(--bg);color:var(--ink)}
  .wrap{max-width:980px;margin:32px auto;padding:0 16px}
  h1{margin:0 0 8px;font-size:28px}
  .sub{color:var(--muted);font-size:14px;margin-bottom:16px}
  .tabs{display:flex;gap:10px;margin:16px 0 20px}
  .tabs button{background:#1c1f26;border:1px solid #2a2f38;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer}
  .tabs button.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(110,231,255,.15) inset}
  .card{background:var(--card);border:1px solid #2a2f38;border-radius:16px;padding:18px;box-shadow:0 6px 20px rgba(0,0,0,.25)}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input[type="date"],select,textarea,input[type="text"]{width:100%;background:#0f1116;color:var(--ink);border:1px solid #2a2f38;border-radius:12px;padding:10px 12px}
  textarea{min-height:280px}
  .small-notes{min-height:60px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#001018;border:0;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer}
  .btn.outline{background:none;border:1px solid #2a2f38;color:var(--ink)}
  .controls{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
  .formGrid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .leftCol{display:flex;flex-direction:column;gap:14px}
  .field{background:#101219;border:1px solid #2a2f38;border-radius:12px;padding:12px}
  .rangeWrap{display:flex;gap:12px;align-items:center}
  .rangeWrap output{min-width:2ch;text-align:center}
  @media (max-width:760px){.formGrid{grid-template-columns:1fr} textarea{min-height:160px}}
  canvas{background:#0f1116;border:1px solid #2a2f38;border-radius:12px}
  .charts{display:grid;gap:16px}
  @media (min-width:860px){.charts{grid-template-columns:1fr 1fr}}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
<div class="wrap">
  <h1>Kato’s T-Gel Daily Tracker</h1>
  <div class="sub">made with love by Ren</div>

  <div class="tabs">
    <button id="tabDaily" class="active">Daily Entry</button>
    <button id="tabOverview">Overview</button>
  </div>

  <!-- DAILY ENTRY -->
  <div id="viewDaily" class="card">
    <div class="formGrid">
      <!-- LEFT COLUMN -->
      <div class="leftCol">
        <!-- Pumps Taken -->
        <div class="field">
          <label for="pumps">Pumps of T-Gel taken today</label>
          <select id="pumps">
            <option value="">-- Select --</option>
            <option value="0.5">½</option>
            <option value="1">1</option>
            <option value="1.5">1.5</option>
            <option value="2">2</option>
          </select>
        </div>
        <!-- Date -->
        <div class="field">
          <label for="date">Date</label>
          <input id="date" type="date">
        </div>
        <!-- Mood -->
        <div class="field">
          <label for="mood">Mood (1–5)</label>
          <div class="rangeWrap">
            <input id="mood" type="range" min="1" max="5" step="1"><output id="moodVal"></output>
          </div>
        </div>
        <!-- Libido -->
        <div class="field">
          <label for="libido">Libido (1–5)</label>
          <div class="rangeWrap">
            <input id="libido" type="range" min="1" max="5" step="1"><output id="libidoVal"></output>
          </div>
        </div>
        <!-- Appetite -->
        <div class="field">
          <label for="appetite">Appetite (1–5)</label>
          <div class="rangeWrap">
            <input id="appetite" type="range" min="1" max="5" step="1"><output id="appetiteVal"></output>
          </div>
        </div>
        <!-- Energy -->
        <div class="field">
          <label for="energy">Energy (1–5)</label>
          <div class="rangeWrap">
            <input id="energy" type="range" min="1" max="5" step="1"><output id="energyVal"></output>
          </div>
        </div>
        <!-- Sleep -->
        <div class="field">
          <label for="sleep">Sleep Quality (1–5)</label>
          <div class="rangeWrap">
            <input id="sleep" type="range" min="1" max="5" step="1"><output id="sleepVal"></output>
          </div>
        </div>
        <!-- Bottom Growth -->
        <div class="field">
          <label>Bottom Growth</label>
          <div class="controls">
            <label><input type="checkbox" id="bgSwelling"> Swelling</label>
            <label><input type="checkbox" id="bgSensitivity"> Sensitivity</label>
          </div>
          <textarea id="bgNotes" class="small-notes" placeholder="Notes on bottom growth"></textarea>
        </div>
        <!-- Skin -->
        <div class="field">
          <label for="skin">Skin Changes (1–5)</label>
          <div class="rangeWrap">
            <input id="skin" type="range" min="1" max="5" step="1"><output id="skinVal"></output>
          </div>
        </div>
        <!-- Voice -->
        <div class="field">
          <label>Voice</label>
          <div class="controls">
            <label><input type="checkbox" id="voiceCracking"> Cracking</label>
            <label><input type="checkbox" id="voiceDeeper"> Deeper tone</label>
            <label><input type="checkbox" id="voiceNoChange"> No change</label>
          </div>
          <textarea id="voiceNotes" class="small-notes" placeholder="Notes on voice"></textarea>
        </div>
        <!-- Period -->
        <div class="field">
          <label for="period">Period?</label>
          <select id="period">
            <option value="">-- Select --</option>
            <option value="none">None</option>
            <option value="spotting">Spotting</option>
            <option value="light">Light</option>
            <option value="medium">Medium</option>
            <option value="heavy">Heavy</option>
          </select>
        </div>
      </div>

      <!-- RIGHT COLUMN -->
      <div>
        <div class="field">
          <label for="notes">General Notes</label>
          <textarea id="notes"></textarea>
        </div>
      </div>
    </div>
    <div class="controls">
      <button class="btn" id="saveBtn">Save Entry</button>
      <button class="btn outline" id="exportCsv">Export CSV</button>
      <input type="file" id="importCsv" style="display:none">
      <button class="btn outline" id="importBtn">Import CSV</button>
      <label class="row" style="font-size:13px;color:var(--muted)">
        <input id="autoBackup" type="checkbox" style="margin-right:8px">
        Auto-backup CSV on Save
      </label>
    </div>
  </div>

  <!-- OVERVIEW -->
  <div id="viewOverview" class="card" style="display:none">
    <div class="charts">
      <canvas id="lineMood"></canvas>
      <canvas id="lineLibido"></canvas>
      <canvas id="lineEnergy"></canvas>
      <canvas id="lineSleep"></canvas>
      <canvas id="barPumps"></canvas>
      <canvas id="barAppetite"></canvas>
      <canvas id="barSkin"></canvas>
      <canvas id="barPeriod"></canvas>
      <canvas id="barBottomGrowth"></canvas>
      <canvas id="barVoice"></canvas>
    </div>
  </div>
</div>

<script>
const $=id=>document.getElementById(id);
const KEY='tgel-tracker-entries-v1';
const BACKUP_KEY='tgel-tracker-auto-backup';

function getEntries(){return JSON.parse(localStorage.getItem(KEY)||'[]');}
function setEntries(list){localStorage.setItem(KEY,JSON.stringify(list));}

function toCSV(rows){
  const headers=Object.keys(rows[0]||{});
  return [headers.join(','),...rows.map(r=>headers.map(h=>JSON.stringify(r[h]||'')).join(','))].join('\\n');
}

function downloadCSV(rows, filename){
  const blob=new Blob([toCSV(rows)],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;a.download=filename;a.click();
  URL.revokeObjectURL(url);
}

function saveEntry(){
  const entry={
    date: $('date').value,
    pumps: $('pumps').value,
    mood: $('mood').value,
    libido: $('libido').value,
    appetite: $('appetite').value,
    energy: $('energy').value,
    sleep: $('sleep').value,
    bgSwelling: $('bgSwelling').checked,
    bgSensitivity: $('bgSensitivity').checked,
    bgNotes: $('bgNotes').value,
    skin: $('skin').value,
    voiceCracking: $('voiceCracking').checked,
    voiceDeeper: $('voiceDeeper').checked,
    voiceNoChange: $('voiceNoChange').checked,
    voiceNotes: $('voiceNotes').value,
    period: $('period').value,
    notes: $('notes').value
  };
  let list=getEntries();
  list=list.filter(e=>e.date!==entry.date);
  list.push(entry);
  setEntries(list);
  if ($('autoBackup').checked){
    const ts=new Date().toISOString().slice(0,19).replace(/[:T]/g,'-');
    downloadCSV(list,`tgel-tracker-backup-${ts}.csv`);
  }
  alert('Saved! Great work, you sexy thing!');
}

$('saveBtn').onclick=saveEntry;
$('exportCsv').onclick=()=>downloadCSV(getEntries(),'tgel-tracker.csv');
$('importBtn').onclick=()=>$('importCsv').click();
$('importCsv').onchange=e=>{
  const file=e.target.files[0];
  if(!file)return;
  const reader=new FileReader();
  reader.onload=()=>{
    const text=reader.result.trim();
    const [header,...lines]=text.split('\\n');
    const keys=header.split(',');
    const data=lines.map(line=>{
      const values=line.split(',').map(v=>JSON.parse(v));
      return Object.fromEntries(keys.map((k,i)=>[k,values[i]]));
    });
    setEntries(data);
    alert('Import complete!');
  };
  reader.readAsText(file);
};

// tab switching
$('tabDaily').onclick=()=>{ $('viewDaily').style.display='block'; $('viewOverview').style.display='none'; $('tabDaily').classList.add('active'); $('tabOverview').classList.remove('active');};
$('tabOverview').onclick=()=>{ $('viewDaily').style.display='none'; $('viewOverview').style.display='block'; $('tabDaily').classList.remove('active'); $('tabOverview').classList.add('active'); renderCharts();};

// init range outputs
['mood','libido','appetite','energy','sleep','skin'].forEach(id=>{
  const inp=$(id),out=$(id+'Val');
  inp.oninput=()=>out.textContent=inp.value;
  inp.oninput();
});

// restore auto-backup setting
try{
  const pref=localStorage.getItem(BACKUP_KEY);
  if(pref!==null) $('autoBackup').checked=pref==='1';
}catch{}
$('autoBackup').onchange=()=>{localStorage.setItem(BACKUP_KEY,$('autoBackup').checked?'1':'0');};

function renderCharts(){
  const data=getEntries().sort((a,b)=>new Date(a.date)-new Date(b.date));
  const labels=data.map(e=>e.date);

  const makeLine=(ctx,label,key)=>new Chart(ctx,{type:'line',data:{labels,datasets:[{label,data:data.map(e=>Number(e[key])||0),borderColor:'cyan'}]},options:{responsive:true}});
  const makeBarCount=(ctx,label,values)=>new Chart(ctx,{type:'bar',data:{labels:Object.keys(values),datasets:[{label,data:Object.values(values),backgroundColor:'orange'}]},options:{responsive:true}});

  makeLine($('lineMood'),'Mood','mood');
  makeLine($('lineLibido'),'Libido','libido');
  makeLine($('lineEnergy'),'Energy','energy');
  makeLine($('lineSleep'),'Sleep','sleep');

  const pumpsCount={};
  data.forEach(e=>{pumpsCount[e.pumps]=(pumpsCount[e.pumps]||0)+1;});
  makeBarCount($('barPumps'),'Pumps Taken',pumpsCount);

  const appetiteCount={};data.forEach(e=>{appetiteCount[e.appetite]=(appetiteCount[e.appetite]||0)+1;});
  makeBarCount($('barAppetite'),'Appetite',appetiteCount);

  const skinCount={};data.forEach(e=>{skinCount[e.skin]=(skinCount[e.skin]||0)+1;});
  makeBarCount($('barSkin'),'Skin',skinCount);

  const periodCount={};data.forEach(e=>{periodCount[e.period]=(periodCount[e.period]||0)+1;});
  makeBarCount($('barPeriod'),'Period',periodCount);

  const bgCount={Swelling:0,Sensitivity:0};data.forEach(e=>{if(e.bgSwelling)bgCount.Swelling++;if(e.bgSensitivity)bgCount.Sensitivity++;});
  makeBarCount($('barBottomGrowth'),'Bottom Growth',bgCount);

  const voiceCount={Cracking:0,'Deeper tone':0,'No change':0};data.forEach(e=>{if(e.voiceCracking)voiceCount.Cracking++;if(e.voiceDeeper)voiceCount['Deeper tone']++;if(e.voiceNoChange)voiceCount['No change']++;});
  makeBarCount($('barVoice'),'Voice',voiceCount);
}
</script>
</body>
</html>




